(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[418],{26675:function(e,t,r){"use strict";r.d(t,{cy:function(){return w},th:function(){return y}});var n=r(809),a=r.n(n),s=r(90268),i=r(9669),c=r.n(i),o=r(22641),u=r.n(o),f=r(88657),p=r(34857),l=a().mark(k),d=a().mark(y),g="".concat("https://api.paperflite.com","/api/2.0"),v="".concat(g,"/asset_viewers"),w=(0,f.Z)(s.Yn,(function(e,t){return{id:e,callback:t}})),h=(0,f.Z)(s.wQ,(function(e){return e})),x=(0,f.Z)(s.xr,(function(e){return e}));function k(e){var t,r,n,s,i,o;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,r=t.id,n=t.callback,s=u()(v,{path:"/page/".concat(r)}),i=function(){return c()({method:"GET",url:s}).then((function(e){return e.data}))},a.prev=3,a.next=6,(0,p.RE)(i);case 6:return o=a.sent,a.next=9,(0,p.gz)(h(o));case 9:n&&n(o),a.next=17;break;case 12:return a.prev=12,a.t0=a.catch(3),console.log(a.t0),a.next=17,(0,p.gz)(x(a.t0));case 17:case"end":return a.stop()}}),l,null,[[3,12]])}function y(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.ib)(s.Yn,k);case 2:case"end":return e.stop()}}),d)}},85526:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return U}});var n=r(809),a=r.n(n),s=r(92447),i=r(85893),c=r(67294),o=r(28216),u=r(11163),f=r(47753),p=r(30797),l=r(68798),d=r(96486),g=r.n(d),v=r(89010),w=r(77371),h=r(38347),x=r(26675),k=r(59755),y=r(26040),b=(r(94184),r(9008)),m=r(40849),_=r(58423),j=r(95628),C=r.n(j);var E=function(e){e.context;var t=e.asset,r=e.page,n=e.widget,a=e.alias,s=e.fetchAsset,p=((0,h.Z)(e,["context","asset","page","widget","alias","fetchAsset"]),(0,o.I0)()),d=((0,u.useRouter)(),(0,c.useState)(null)),v=d[0],w=d[1],x=(0,o.v9)((function(e){return g().get(e,"assetViewers.loading")})),j=(0,o.v9)((function(e){return g().get(e,"assetViewers.item")})),E=(0,_.Wi)(g().get(j,"content.properties",{}));(0,c.useEffect)((function(){p((0,f.$A)()),p((0,k.pK)())}),[]),(0,c.useEffect)((function(){var e=(0,l.M8)();w(e)}),[]),(0,c.useEffect)((function(){!x&&j&&j.content&&j.content.widgets&&p((0,y.K5)(v,{type:"asset_viewer",id:j.id},j.content.widgets))}),[j&&j.id,x]);var q=(0,o.v9)((function(e){var t={};if(!v)return t;var r=e.widgets.editors[v];return r&&(t=r.widgetsById),t})),R=(0,o.v9)((function(e){var t=[];if(!v)return t;var r=e.widgets.editors[v];return r&&(t=r.widgets),t})).filter((function(e){return"widgets.custom.password"!==q[e].type}));R=R.map((function(e){return q[e]}));var U=g().get(j,"content.properties.css",""),A=g().get(j,"content.properties.script",""),N={type:"asset_viewer",id:j&&j.id};return v?(0,i.jsxs)("div",{className:C().page,style:E,children:[j&&(0,i.jsxs)(b.default,{children:[(0,i.jsx)("title",{children:"".concat(j.name)}),(0,i.jsx)("style",{type:"text/css",children:U}),(0,i.jsx)("script",{type:"text/javascript",children:A}),(0,i.jsx)("base",{target:"_blank"})]}),x&&!j&&(0,i.jsx)(m.Z,{active:!0,children:"Loading Element..."}),R&&R.map((function(e){return(0,i.jsx)(_.$L,{item:e,editor:v,entityReference:N,context:a,asset:t,page:r,widget:n,alias:a,fetchAsset:s,assetViewer:!0},e.id)}))]}):null},q=r(47041),R=function(){var e=(0,o.I0)(),t=(0,u.useRouter)(),r=t.query,n=r.alias,a=r.widget,s=r.page,p="/".concat((n||[]).join("/")),l=(0,o.v9)((function(e){return g().get(e,"resourceCenter.resource[".concat(p,"].item"),null)})),d=((0,o.v9)((function(e){return g().get(e,"resourceCenter.resource[".concat(p,"].loading"),!1)})),(0,o.v9)((function(e){return g().get(e,"resourceCenter.resource[".concat(p,"].loading"))})));if((0,c.useEffect)((function(){var t=!1;if(p&&!l)t=!0;else if(l){var r=l.entityType;"asset"===r&&l.partial&&(t=!0),"asset"===r&&l.assetViewer&&e((0,x.cy)(l.assetViewer))}if(t){var n={};a&&(n={widget:a,page:s}),e((0,f.DU)(p,n))}}),[p,l]),(0,c.useEffect)((function(){if(d&&36001===d.errorCode){var e=d.loginUrl;if(e){var r="".concat(e,"&redirect=").concat(origin).concat(p);t.push(r)}}}),[d]),!l)return null;var h=function(){var t={};a&&(t={widget:a,page:s}),e((0,f.DU)(p,t))};switch(l.entityType){case"page":return(0,i.jsx)(v.B,{page:l,alias:p});case"asset":var k=s||g().get(l,"page.alias"),y=a||g().get(l,"widget.id");return l.assetViewer?(0,i.jsx)(E,{context:l.alias,asset:l,page:k,widget:y,alias:p,fetchAsset:h}):(0,i.jsx)(w.l,{context:l.alias,asset:l,page:k,widget:y,alias:p,fetchAsset:h});default:return null}};R.getInitialProps=function(){var e=(0,s.Z)(a().mark((function e(t){var r,n,s,i,c,o,u,d,v,w,h,x,k,y,b,m,_;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.query,n=t.req,s=t.res,i=t.store,c=t.asPath,o=(0,l.q6)(n),u=r.alias,d=r.widget,v=r.page,w="/".concat((u||[]).join("/")),h=(0,q.getCookie)("_cleverstory_token",{req:n,res:s}),x=(0,q.getCookie)("hubspotutk",{req:n,res:s}),console.log("URL: "+c),k={},d&&(k={widget:d,page:v}),i.dispatch((0,f.jF)(o)),i.dispatch((0,f.hD)(w,k,h,x)),!t.req){e.next=29;break}return t.store.dispatch(p.uR),e.next=15,t.store.sagaTask.toPromise();case 15:if(y=g().get(i.getState(),"resourceCenter.item"),!(b=g().get(i.getState(),"resourceCenter.error"))||36001!==b.errorCode){e.next=24;break}if(!(m=b.loginUrl)){e.next=24;break}return _="".concat(m,"&redirect=").concat(encodeURIComponent(o+c)),console.log("Login Url: ".concat(_)),s&&(s.writeHead(307,{Location:_}),s.end()),e.abrupt("return",{});case 24:if(y){e.next=26;break}return e.abrupt("return",{statusCode:404});case 26:if(g().get(i.getState(),"resourceCenter.resource[".concat(w,"].item"))){e.next=29;break}return e.abrupt("return",{statusCode:404});case 29:return e.abrupt("return",{});case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var U=R},86529:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[[...alias]]",function(){return r(85526)}])},95628:function(){}},function(e){e.O(0,[774,662,544,296,33,885,361,809,597,350,665,700,96,233,414],(function(){return t=86529,e(e.s=t);var t}));var t=e.O();_N_E=t}]);